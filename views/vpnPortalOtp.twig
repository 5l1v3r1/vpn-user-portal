<!DOCTYPE html>

<html lang="en">
{% include 'head.twig' %}
<body>
    {% include 'header.twig' %}

    <ul class="menu">
      <li><a href="new">{% trans "New" %}</a></li>
      <li><a href="configurations">{% trans "Configurations" %}</a></li>
      <li class="active"><a href="account">{% trans "Account" %}</a></li>
      <li><a href="documentation">{% trans "Documentation" %}</a></li>
    </ul>

    <p>
        {% trans "Here you can enroll for two-factor authentication (2FA)." %}
    </p>
        
    <dl>
        <dt>{% trans "Secret" %}</dt>
        <dd><code>{{ otpSecret|e }}</code></dd>
        <dt>QR</dt>
        <dd><img src="otp-qr-code?otp_secret={{ otpSecret|e }}"></dd>
    </dl>

    <p>
        {% trans "Scan the QR code using your 2FA application, or import the secret manually. Confirm the successful configuration by entering a 6 digit OTP generated by the application below." %}
    </p>

    <form method="post" action="otp">
        <fieldset>
            <label for="otp_key">OTP</label>
            <input type="text" id="otp_key" name="otp_key" maxlength="6" required pattern="[0-9]{6}" autofocus>
            <input type="hidden" name="otp_secret" value="{{ otpSecret|e }}"> 
        </fieldset>
        <fieldset>
            <button>{% trans "Validate" %}</button>
        <fieldset>
    </form>

    {% include 'footer.twig' %}

</body>
</html>
