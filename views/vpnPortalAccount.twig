<!DOCTYPE html>

<html lang="en">
{% include 'head.twig' %}
<body>
    {% include 'header.twig' %}

    <ul class="menu">
      <li><a href="new">{% trans "New" %}</a></li>
      <li><a href="configurations">{% trans "Configurations" %}</a></li>
      <li class="active"><a href="account">{% trans "Account" %}</a></li>
      <li><a href="documentation">{% trans "Documentation" %}</a></li>
    </ul>

    <h2>{% trans "User ID" %}</h2>
    <p>
        {% trans %}
            Your user identity is <code>{{ userId }}</code>.
        {% endtrans %}
    </p>

    {% if userGroups is not empty %}
        <h2>{% trans "Group Membership" %}</h2>
        <p>
            {% trans "You are a member of the following groups:" %}
        </p>
            <ul>
                {% for group in userGroups %}
                    <li title="{{ group.id }}">{{ group.displayName }}</li>
                {% endfor %}
            </ul>
    {% endif %}
    
    {% if otpEnabledPools is not empty %}
        <h2>{% trans "Two-factor Authentication" %}</h2>
        <p>
        {% trans %}Two-factor authentication is required by these VPN profiles: {% endtrans %}
        </p>
        <ul>
        {% for otpEnabledPool in otpEnabledPools %}
            <li>{{ otpEnabledPool }}</li>
        {% endfor %}
        </ul>

        <p>
            {% if hasOtpSecret %}
                <p class="success">
                {% trans %}
                    You are enrolled!
                {% endtrans %}
                </p>
            {% else %}
                <p class="warning">
                {% trans %}
                    You are not yet enrolled! Enroll <a href="otp">here</a>.
                {% endtrans %}
                </p>
            {% endif %}
        </p>
    {% endif %}

    {% if authorizedClients is not empty %}
        <h2>{% trans "Authorized Applications" %}</h2>
        <p>
            {% trans %}
                This is a list of applications you gave permission to access your account.
            {% endtrans %}
        </p>

        <table class="horizontal">
            <thead>
                <tr><th>{% trans "Name" %}</th><th>{% trans "Scope" %}</th><th></th></tr>
            </thead>
            <tbody>
                {% for client in authorizedClients %}
                <tr>
                    <td>{{ client.client_id }}</td>
                    <td><code>{{ client.scope }}</code></td>
                    <td class="text-right">
                        <form method="post" action="removeClientAuthorization">
                            <input type="hidden" name="client_id" value="{{ client.client_id }}">
                            <button class="error">{% trans "Revoke" %}</button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}

    {% include 'footer.twig' %}
</body>
</html>
